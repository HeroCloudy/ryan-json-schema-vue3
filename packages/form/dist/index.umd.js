(function(d,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("vue"),require("element-plus")):typeof define=="function"&&define.amd?define(["exports","vue","element-plus"],n):(d=typeof globalThis<"u"?globalThis:d||self,n(d.form={},d.Vue,d.elementPlus))})(this,function(d,n,u){"use strict";const _="ui:hidden",k="ui:disabled",v="ui:width",j="ui:options",E="ui:widget",$="ui:column";var f=(e=>(e.SELECT="select",e.RADIO="radio",e.CHECKBOX="checkbox",e.SWITCH="switch",e.INPUT="input",e.TEXTAREA="textarea",e))(f||{}),g=(e=>(e.STRING="string",e.NUMBER="number",e.ARRAY="array",e.BOOLEAN="boolean",e))(g||{});const B={schema:{type:Object,required:!0},uiSchema:{type:Object,required:!1,default:()=>({})}},ee=(e,t)=>{if(t==null)return e;if(t.length===0)return{...e,properties:{}};const o={};return t.forEach(r=>{e.properties[r]&&(o[r]=e.properties[r])}),{...e,properties:o}};class y{constructor(t,o,r){this.schema=t,this.uiSchema=o,this.model=r,this.commonProps=this.initCommonProps(),this.prop=this.schema.prop}initCommonProps(){const t={...this.uiSchema[j]||{}};return t.disabled=this.uiSchema[k]===!0,t.placeholder=t.placeholder||this.schema.description,t}}function te(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!n.isVNode(e)}class W extends y{render(){let t;const{oneOf:o}=this.schema;return n.createVNode(u.ElRadioGroup,n.mergeProps(this.commonProps,{modelValue:this.model[this.prop],"onUpdate:modelValue":r=>this.model[this.prop]=r}),te(t=o.map(r=>n.createVNode(u.ElRadio,{label:r.const},{default:()=>[r.title]})))?t:{default:()=>[t]})}}function re(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!n.isVNode(e)}class D extends y{render(){let t;const{oneOf:o,anyOf:r}=this.schema,s=!!r,i=o||r||[];return n.createVNode(u.ElSelect,n.mergeProps(this.commonProps,{modelValue:this.model[this.prop],"onUpdate:modelValue":a=>this.model[this.prop]=a,style:{width:"100%"},multiple:s,clearable:!0}),re(t=i.map(a=>n.createVNode(u.ElOption,{label:a.title,value:a.const},null)))?t:{default:()=>[t]})}}class L extends y{render(){let{format:t}=this.schema;const{type:o}=this.schema;return o===g.ARRAY&&(t+="range",this.commonProps["range-separator"]=this.commonProps["range-separator"]||"-"),n.createVNode(u.ElDatePicker,n.mergeProps(this.commonProps,{modelValue:this.model[this.prop],"onUpdate:modelValue":r=>this.model[this.prop]=r,type:t,clearable:!0}),null)}}class oe extends y{render(){const t=this.uiSchema[E]==="textarea"?"textarea":"text";return n.createVNode(u.ElInput,n.mergeProps(this.commonProps,{type:t,modelValue:this.model[this.prop],"onUpdate:modelValue":o=>this.model[this.prop]=o,clearable:!0}),null)}}class ne extends y{render(){return n.createVNode(u.ElInputNumber,n.mergeProps({style:{width:"100%"}},this.commonProps,{modelValue:this.model[this.prop],"onUpdate:modelValue":t=>this.model[this.prop]=t}),null)}}class H extends y{render(){return n.createVNode(u.ElSwitch,n.mergeProps(this.commonProps,{modelValue:this.model[this.prop],"onUpdate:modelValue":t=>this.model[this.prop]=t}),null)}}function se(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!n.isVNode(e)}class ie extends y{render(){let t;const{anyOf:o=[]}=this.schema;return n.createVNode(u.ElCheckboxGroup,n.mergeProps(this.commonProps,{modelValue:this.model[this.prop],"onUpdate:modelValue":r=>this.model[this.prop]=r}),se(t=o.map(r=>n.createVNode(u.ElCheckbox,{label:r.const},{default:()=>[r.title]})))?t:{default:()=>[t]})}}function ce(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!n.isVNode(e)}const ae=(e,t={},o,r,s,i)=>{let a;const l=e.prop;if(t[_])return null;const p={...t,[E]:t[E],[j]:{...t[j]||{},onKeyup:c=>{c.code==="Enter"&&i.enter(c)},onChange:c=>i.change(l,c)}};e.prop==="startTime"&&console.log(e);const m={item:e,uiItem:p,model:o},h=()=>{if(r&&r[l])return()=>r[l](o);switch(e.type){case g.STRING:return J(m);case g.NUMBER:return le(m);case g.BOOLEAN:return de(m);case g.ARRAY:return pe(m)}return J(m)},b=t[$]||1,C=(t[j]||{}).labelWidth||"auto";return n.createVNode(u.ElCol,{span:s*b},{default:()=>[n.createVNode(u.ElFormItem,{label:e.description,prop:l,"label-width":C},ce(a=h())?a:{default:()=>[a]})]})},I=(e="不支持该类型")=>n.createVNode("div",null,[e]),J=e=>{const{model:t,item:o,uiItem:r}=e;if(o.oneOf){const s=r[E]||f.SELECT;return s===f.RADIO?new W(o,r,t).render():s===f.SELECT?new D(o,r,t).render():I()}return o.format&&(o.format==="date"||o.format==="datetime")?new L(o,r,t).render():new oe(o,r,t).render()},le=e=>{const{model:t,item:o,uiItem:r}=e;return r&&r[E]===f.SWITCH?new H(o,r,t).render():new ne(o,r,t).render()},de=e=>{const{model:t,item:o,uiItem:r}=e,s=r[E]||f.SWITCH,i=[{const:!0,title:"是"},{const:!1,title:"否"}];return o.oneOf=o.oneOf?o.oneOf:i,s===f.SWITCH?new H(o,r,t).render():s===f.RADIO?new W(o,r,t).render():s===f.SELECT?new D(o,r,t).render():I()},pe=e=>{const{model:t,item:o,uiItem:r}=e;if(o.anyOf){const s=r[E]||"select";if(s===f.SELECT)return new D(o,r,t).render();if(s===f.CHECKBOX)return new ie(o,r,t).render()}return o.format&&(o.format==="date"||o.format==="datetime")?new L(o,r,t).render():I()},me=(e={},t)=>{const o={...e},{properties:r}=t,{required:s=[]}=t;return s.forEach(i=>{if(r[i]){const a=r[i].prop||i;G(o,a,x(r[i].description))}}),Object.keys(r).forEach(i=>{const a=r[i],l=a.prop||i;a.required&&s.findIndex(p=>p===l)<0&&G(o,l,x(r[i].description))}),o},G=(e,t,o)=>{e[t]||(e[t]=[]),e[t].push(o)},x=e=>({required:!0,message:`${e}不能为空`,trigger:"blur"}),T={...B,model:{type:Object,required:!0},column:{type:Number,required:!1,default:3},rules:{type:Object,required:!1,default:()=>({})}},q={...T,fields:{type:Array,required:!1}},M={...B,model:{type:Object,required:!0},column:{type:Number,required:!1,default:3},size:{type:String,required:!1,default:"default"},border:{type:Boolean,required:!1,default:!0}},F={...M,fields:{type:Array,required:!1}},K={...q,...F,readMode:{type:Boolean,required:!1,default:!1}};function ue(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!n.isVNode(e)}const X="ry-json-form",O=n.defineComponent({name:X,props:T,setup(e,t){const o=n.ref();let r=n.reactive(e.model);const s=()=>{o.value&&o.value.resetFields()},i=c=>{o.value&&o.value.validate(c)};t.expose({reset:s,validate:i});let a=24/e.column;n.watchEffect(()=>{r=n.reactive(e.model),a=24/e.column});const m={change:(c,N)=>{t.emit("data-change",c,N,r)},enter:c=>{t.emit("enter-up",c,e.model)}},h=()=>{o.value&&o.value.clearValidate();const{properties:c}=e.schema,N=[];return Object.keys(c).forEach(A=>{const w=c[A];w.prop=w.prop||A;const Z=e.uiSchema[A],U=ae(w,Z,e.model,t.slots,a,m);U&&N.push(U)}),N},b=n.computed(()=>{const{schema:c,rules:N}=e;return me(N,c)}),C=c=>{c&&(c.stopPropagation&&c.stopPropagation(),c.preventDefault&&c.preventDefault())};return()=>{let c;const{schema:N,uiSchema:A,model:w,column:Z,rules:U,...ye}=e;return n.createVNode("div",{className:X},[n.createVNode(u.ElForm,n.mergeProps(ye,{ref:o,model:r,rules:b.value,labelWidth:"auto",onSubmit:C}),{default:()=>[n.createVNode(u.ElRow,{gutter:20},ue(c=h())?c:{default:()=>[c]})]})])}}});O.install=e=>{e.component(O.name,O)};const Y=e=>({reset:()=>{const r=e();r&&r.reset()},validate:r=>{const s=e();s&&s.validate(r)}}),z=(e,t)=>({onDataChange:(s,i)=>{e.emit("data-change",s,i,t)},onEnterUp:s=>{e.emit("enter-up",s,t)}}),S=n.defineComponent({name:"ry-pro-form",props:q,setup(e,t){const o=n.ref(),{reset:r,validate:s}=Y(()=>o.value);t.expose({reset:r,validate:s});const i=n.computed(()=>{if(!e.fields)return e.schema;const l={};return e.schema&&e.schema.properties&&e.fields.forEach(p=>{e.schema.properties[p]&&(l[p]=e.schema.properties[p])}),{...e.schema,properties:l}}),a=n.computed(()=>{const l={...e};return delete l.fields,l});return()=>n.createVNode(O,n.mergeProps({ref:o},a.value,{schema:i.value},z(t,e.model)),t.slots)}});S.install=e=>{e.component(S.name,S)};const fe=(e,t={},o,r)=>{if(t[_]===!0)return null;const s=e.prop,i=()=>{const l=o[s];if(e.oneOf){const p=e.oneOf.find(m=>m.const===l);return p?p.title:l}return e.anyOf?typeof l=="string"?l.split(",").map(m=>{var b;const h=(b=e.anyOf)==null?void 0:b.find(C=>C.const===m);return h?h.title:m}).join(","):l.map(p=>{var h;const m=(h=e.anyOf)==null?void 0:h.find(b=>b.const===p);return m?m.title:p}).join(","):l},a=t[j]||{};return n.createVNode(n.resolveComponent("el-descriptions-item"),n.mergeProps(a,{span:t[$]||1,width:t[v]||100,label:e.description||""}),{default:()=>[r[s]?r[s](o):i()]})};function he(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!n.isVNode(e)}const V=n.defineComponent({name:"ry-json-description",props:M,setup(e,t){const o=()=>{const{properties:r}=e.schema,s=[];return Object.keys(r).forEach(i=>{const a=r[i];a.prop=a.prop||i;const l=e.uiSchema[i],p=fe(a,l,e.model,t.slots);p&&s.push(p)}),s};return()=>{let r;const{column:s}=e;return n.createVNode(n.resolveComponent("el-descriptions"),n.mergeProps(t.attrs,{column:s,border:!0}),he(r=o())?r:{default:()=>[r]})}}});V.install=e=>{e.component(V.name,V)};const P=n.defineComponent({name:"ry-pro-description",props:F,setup(e,t){const o=t.attrs,r=n.computed(()=>ee(e.schema,e.fields)),s=n.computed(()=>{const i={...e};return delete i.fields,i});return()=>n.createVNode(V,n.mergeProps(o,s.value,{schema:r.value}),t.slots)}});P.install=e=>{e.component(P.name,P)};const R=n.defineComponent({name:"ry-json-form-description",props:K,setup(e,{slots:t}){return()=>{const{readMode:o,...r}=e;return o?n.createVNode(P,r,{default:()=>[n.createTextVNode("description")],...t}):n.createVNode(S,r,{default:()=>[n.createTextVNode("form")],...t})}}});R.install=e=>{e.component(R.name,R)};const be=[O,S,V,P,R],Q=e=>{be.forEach(t=>{e.component(t.name,t)})},Ee={install:Q};d.JsonDescription=V,d.JsonForm=O,d.JsonFormDescription=R,d.ProDescription=P,d.ProForm=S,d.basicDescriptionProps=M,d.basicFormProps=T,d.bindEvent=z,d.bindMethod=Y,d.default=Ee,d.install=Q,d.jsonFormDescriptionProps=K,d.proDescriptionProps=F,d.proFormProps=q,Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
