(function(n,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue"),require("xe-utils"),require("vxe-table"),require("element-plus")):typeof define=="function"&&define.amd?define(["exports","vue","xe-utils","vxe-table","element-plus"],t):(n=typeof globalThis<"u"?globalThis:n||self,t(n.table={},n.Vue,n.XEUtils,n.vxeTable,n.elementPlus))})(this,function(n,t,F,j,S){"use strict";const q="ui:width",k="ui:options",C={...{schema:{type:Object,required:!0},uiSchema:{type:Object,required:!1,default:()=>({})}},model:{type:Array,required:!0},showPager:{type:Boolean,required:!1,default:!0},showIndex:{type:Boolean,required:!1,default:!1},selectionType:{type:String,required:!1,default:""},pageInfo:{type:Object,required:!1,default:()=>({currentPage:0,pageSize:10,total:0})},rowBtnList:{type:Function,required:!1,default:null},tableLoading:{type:Boolean,required:!1,default:!1},optWidth:{type:String,required:!1,default:"150"},rowKey:{type:String,required:!1,default:"_X_ROW_KEY"}},N={...C,fields:{type:Array,required:!1}};function D(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!t.isVNode(e)}const x=(e,o)=>{const{type:f="default",key:g,flag:r,title:i}=e;if(r==="DEL"){const s={reference:()=>t.createVNode(S.ElButton,{type:"danger",link:!0},D(i)?i:{default:()=>[i]})};return t.createVNode(S.ElPopconfirm,{title:"是否确认删除该记录？","cancel-button-text":"取消","cancel-button-type":"text","confirm-button-text":"删除","confirm-button-type":"danger",onConfirm:()=>o(g)},s)}return t.createVNode(S.ElButton,{type:f,link:!0,onClick:()=>o(g)},D(i)?i:{default:()=>[i]})},L="ry-json-table",R="InnerOptColumn",y=t.defineComponent({name:L,props:C,setup(e,o){const f=t.computed(()=>({align:"center",columnConfig:{resizable:!0},loading:e.tableLoading})),g=t.computed(()=>({isHover:!0,useKey:!0,keyField:e.rowKey||"_X_ROW_KEY"})),r=t.ref(),i=()=>r.value;o.expose({getXTableRef:i});const s=a=>{if(e.pageInfo){const{pageInfo:d}=e;d.currentPage=a.currentPage,d.pageSize=a.pageSize}o.emit("page-change",a)},c=t.computed(()=>({...e.pageInfo})),V=()=>t.createVNode(t.resolveComponent("vxe-pager"),{layouts:["Total","Sizes","PrevPage","JumpNumber","NextPage","FullJump"],"current-page":c.value.currentPage,"onUpdate:current-page":a=>c.value.currentPage=a,"page-size":c.value.pageSize,"onUpdate:page-size":a=>c.value.pageSize=a,total:c.value.total,onPageChange:s},null),W=t.computed(()=>{const{schema:a,uiSchema:d,showIndex:w,selectionType:O}=e,u=[];O==="checkbox"&&u.push({type:"checkbox",width:50,fixed:"left"}),w&&u.push({type:"seq",width:50,fixed:"left",align:"center",title:"序号"});const H=({cellValue:p})=>F.toDateString(p,"yyyy-MM-dd HH:mm:ss");Object.keys(a.properties).forEach(p=>{const l=a.properties[p];l.prop=l.prop||p;const B=d[p]||{},E=B[k]||{},m={field:l.prop,title:l.description||l.prop,headerAlign:"center",align:"center",showOverflow:!0,...E};if(B[q]?m.width=B[q]:p.includes("Time")&&(m.width=200),o.slots[p]&&(m.slots={default:p}),l.format)switch(l.format){case"date-time":m.formatter=H;break}E.formatter&&typeof E.formatter=="function"?m.formatter=E.formatter:l.oneOf?m.formatter=({cellValue:b})=>{const h=l.oneOf.find(P=>P.const===b);return(h==null?void 0:h.title)||b}:l.anyOf&&(m.formatter=({cellValue:b})=>{let h=[];return typeof b=="string"?h=b.split(","):h=b,h.map(P=>{const _=l.anyOf.find(G=>G.const===P);return(_==null?void 0:_.title)||P}).join(",")}),u.push(m)});const{rowBtnList:Y}=e;return Y!==null&&u.push({width:e.optWidth,fixed:"right",align:"center",title:"操作",slots:{default:R}}),u}),X=({row:a})=>{const{rowBtnList:d}=e;let w=[];typeof d=="function"?w=d(a):w=d;const O=u=>{o.emit("row-btn-click",u,a)};return w.map(u=>x(u,O))},A=()=>{r.value&&o.emit("row-selected",r.value.getCheckboxRecords())},K={...o.slots,[R]:X,pager:e.showPager?V:null},J=t.computed(()=>e.model||[]);return()=>t.createVNode("div",{class:L},[t.createVNode(j.VxeGrid,t.mergeProps(o.attrs,{ref:r},f.value,{columns:W.value,data:J.value,height:"auto",rowConfig:g.value,onCheckboxChange:A,onCheckboxAll:A}),K)])}});y.install=e=>{e.component(y.name,y)};const T=t.defineComponent({name:"ry-pro-table",props:N,setup(e,o){const f=t.ref(),g=t.computed(()=>{if(!e.fields)return e.schema;const s={};return e.fields.forEach(c=>{e.schema.properties[c]&&(s[c]=e.schema.properties[c])}),{...e.schema,properties:s}}),r=t.computed(()=>{const s={...e};return delete s.fields,s}),i=()=>f.value&&f.value.getXTableRef();return o.expose({getXTableRef:i}),()=>t.createVNode(y,t.mergeProps({ref:f},r.value,{schema:g.value}),o.slots)}});T.install=e=>{e.component(T.name,T)};const z=e=>({onRowBtnClick:(r,i)=>{e.emit("row-btn-click",r,i)},onRowSelected:r=>{e.emit("row-selected",r)},onPageChange:r=>{e.emit("page-change",r)}}),v=[{key:"DEFAULT_EDIT",title:"编辑",type:"primary",flag:"EDIT"},{key:"DEFAULT_DEL",title:"删除",type:"danger",flag:"DEL"}],M=[y,T],I=e=>{M.forEach(o=>{e.component(o.name,o)})},U={install:I};n.DEFAULT_ROW_BTN_LIST=v,n.JsonTable=y,n.ProTable=T,n.basicTableProps=C,n.bindEvent=z,n.default=U,n.install=I,n.proTableProps=N,Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
